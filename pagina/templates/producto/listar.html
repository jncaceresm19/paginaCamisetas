{% extends "pagina/base.html" %}

{% block js %}

<script>
    function eliminarProducto(id) {
       Swal.fire({
           title: "¿Estás seguro que deseas eliminar?",
           text: "Esta acción no se puede deshacer",
           icon: "question",
           showCancelButton: true,
           cancelButtonText: "No, Cancelar",
           confirmButtonText: "Sí, Eliminar",
           reverseButtons: true, 
           cancelButtonColor: "#DD6B55",
           confirmButtonColor: "#000",
       })
       .then(function(result){
           if(result.isConfirmed){
               window.location.href = "/eliminar-producto/"+id+"/"
           }
       });
    }
</script>

{% endblock %}


{% block contenido %}
{% load humanize %}
<html>
<head>
</head>
<body>
    <br><div class="container">
        <div class="row">
            <center><h1>Listado de Productos</h1></center>
        </div>
        <br>
        <div class="row mb-3">
            <table class="table table-light  table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>Nombre</th>
                        <th>Descripción</th>
                        <th>Stock</th>
                        <th>Precio</th>
                        <th>Fecha</th>
                        <th>Marca</th>
                        <th>Tallas</th>
                        <th>Imagen</th>
                        <th></th>
                        <th></th>
                    </tr>
                </thead>
                {% for p in producto %}
                <tr>
                    <td>{{ p.nombre | title }}</td>
                    <td>{{ p.descripcion }}</td>
                    <td>{{ p.stock }}</td>
                    <td>${{ p.precio | intcomma}}</td>
                    <td>{{ p.fecha_recepcion }}</td>
                    <td>{{ p.marca | title }}</td>
                    <td>
                        {% for talla in p.talla.all %}
                            {{ talla.nombre }}{% if not forloop.last %}, {% endif %}
                        {% endfor %}
                    </td>
                    {% if p.imagen %}
                        <td><img src="{{ p.imagen.url}}" alt="no disponible" style="height: 70px;"></td>
                    {% endif %}
                    {% if perms.pagina.change_producto %}
                    <td><a class="btn btn-primary" href="{% url 'modificar_producto' p.id %}">Editar</a></td> 
                    {% endif %}
                    {% if perms.pagina.delete_producto %}
                    <td><a class="btn btn-primary" href="#" onclick="eliminarProducto({{ p.id }})" >Eliminar</a></td>
                    {% endif %}
                </tr>
                {% endfor %}
            </table>
        </div>
        <br>
        <div class="row">
            <a class="btn btn-primary" href="{% url 'agregar_producto' %}">Agregar Producto</a>
        </div>
    </div><br><br>
</body>
</html>
{% endblock %}


